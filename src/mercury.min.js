"use strict";angular.module("mercury",[]).provider("Mercury",[function(){function r(r){function e(t){this.search=function(e){var n=t+"select",o={wt:"json","json.wrf":"JSON_CALLBACK"};if(angular.isArray(e["facet.field"])){for(var s=0;s<e["facet.field"].length;s++)0==s&&(n+="?"),n+="facet.field="+e["facet.field"][s]+"&";delete e["facet.field"]}if(angular.isArray(e.fq)){for(var i=0;i<e.fq.length;i++)n+="&fq="+e.fq[i]+"&";delete e.fq}return angular.extend(o,e),r.jsonp(n,{params:o})},this.withEndpoint=function(r){return new e(r)}}return new e(t)}function e(r){t=r}var t="";return{$get:["$http",r],setEndpoint:e}}]).directive("mercurySearch",[function(){return{restrict:"AE",transclude:!0,replace:!1,template:"<div data-ng-transclude></div>",scope:{q:"@query",start:"@",rows:"@",sort:"@",fl:"@fields",indexUrl:"@"},controller:["$scope","$rootScope","Mercury",function(r,e,t){var n=r.indexUrl?t.withEndpoint(r.indexUrl):t,o={q:r.q||"*:*",start:r.start||0,rows:r.rows||10};r.sort&&(o.sort=r.sort),r.fl&&(o.fl=r.fl),n.search(o).then(function(t){var n=t.data.response,o=r.$$nextSibling;o.solr=e.solr||{},o.solr.results=n.docs,o.solr.count=n.numFound})}]}}]);